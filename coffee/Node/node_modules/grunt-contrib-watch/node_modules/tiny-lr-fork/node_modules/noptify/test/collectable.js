/***
 * Excerpted from "CoffeeScript: Accelerated JavaScript Development, Second Edition",
 * published by The Pragmatic Bookshelf.
 * Copyrights apply to this code. It may not be used to create training material, 
 * courses, books, articles, and the like. Contact us if you are in doubt.
 * We make no guarantees that this code is fit for any purpose. 
 * Visit http://www.pragmaticprogrammer.com/titles/tbcoffee2 for more book information.
***/
var noptify = require('..');
var assert = require('assert');


describe('Collectable', function() {

  it('provides the helper method to read from stdin', function() {
    var program = noptify();
    assert.ok(typeof program.stdin === 'function', 'stdin defined');
  });

  it('is invoked only when .parse() is called', function(done) {
    var program = noptify(['', '']);
    var str = 'testing out stdin helper';
    program.stdin(function(err, res) {
      assert.equal(res, str);
      done();
    });

    program.parse();

    process.nextTick(function() {
      process.stdin.emit('data', str);
      process.stdin.emit('end');
    });
  });


  it('.files()', function(done) {
    var program = noptify(['', '', 'test/fixtures/a.js', 'test/fixtures/b.js']);
    program.parse();

    program.files(function(err, data) {
      assert.equal(data, 'a\nb\n');
      done();
    });

  });

});
